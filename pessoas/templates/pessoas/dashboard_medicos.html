{% extends 'pessoas/dashboard_base.html' %}

{% block title %}Dashboard - Médicos{% endblock %}

{% block page_icon %}<i class="bi bi-person-badge"></i>{% endblock %}
{% block page_title %}Gerenciar Médicos{% endblock %}

{% block content %}
<div class="stats-grid" style="margin-bottom: 30px;">
    <div class="stat-card accent-4">
        <div class="stat-card-header">
            <h3>Total de Médicos</h3>
            <div class="stat-card-icon">
                <i class="bi bi-person-badge-fill"></i>
            </div>
        </div>
        <div class="stat-value">{{ medicos|length }}</div>
        <div class="stat-label">profissionais cadastrados</div>
    </div>
</div>

<div class="data-table-container">
    <div class="table-header-bar">
        <div class="table-title">
            <i class="bi bi-hospital"></i>
            Equipe Médica
        </div>
        <a href="{% url 'cadastro' %}" class="btn-action btn-success">
            <i class="bi bi-person-plus"></i>
            Novo Médico
        </a>
    </div>
    
    {% if medicos %}
    <table class="data-table">
        <thead>
            <tr>
                <th>Médico</th>
                <th>E-mail</th>
                <th>Especialidade</th>
                <th>Cargo</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for medico in medicos %}
            <tr>
                <td>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                            {{ medico.username|slice:":1"|upper|default:"M" }}
                        </div>
                        <div>
                            <strong>Dr(a). {{ medico.username }} {{ medico.last_name }}</strong>
                            <div style="font-size: 0.85rem; color: #8c9ba8;">@{{ medico.username }}</div>
                        </div>
                    </div>
                </td>
                <td>{{ medico.email|default:"-" }}</td>
                <td>
                    {% if medico.perfil.endereco %}
                        <span class="status-badge confirmada">{{ medico.perfil.endereco }}</span>
                    {% else %}
                        <span style="color: #8c9ba8;">Não informada</span>
                    {% endif %}
                </td>
                <td>
                    <span class="status-badge agendada">
                        {{ medico.perfil.get_tipo_usuario_display }}
                    </span>
                </td>
                <td>
                    <div class="action-buttons">
                        <a href="{% url 'gerenciar_cargos' medico.id %}" class="btn-action btn-editar">
                            <i class="bi bi-person-gear"></i>
                            Cargo
                        </a>
                        <form method="post" action="{% url 'remover_medico' medico.id %}" style="display: inline;" onsubmit="return confirm('Tem certeza que deseja remover este médico?');">
                            {% csrf_token %}
                            <button type="submit" class="btn-action btn-remover">
                                <i class="bi bi-trash"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <i class="bi bi-person-badge"></i>
        <h4>Nenhum médico cadastrado</h4>
        <p>Clique no botão acima para adicionar um novo médico.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
